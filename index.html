<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Terminal Madame Solomi‚Äôna</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg-color: #f4f7f9;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-light: #8e8e93;
            --accent-blue: #3498db;
            --accent-green: #2ecc71;
            --accent-gradient: linear-gradient(135deg, #3498db, #2980b9);
            --green-gradient: linear-gradient(135deg, #2ecc71, #27ae60);
            --card-shadow: 0 4px 12px rgba(0,0,0,0.06);
            --item-border: #f0f0f0;
            --nav-bg: rgba(255, 255, 255, 0.85);
            --nav-border: rgba(255, 255, 255, 0.5);
            --coupon-blue-bg: rgba(52, 152, 219, 0.08);
            --danger: #ff4757;
        }

        body.dark-mode {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f1f5f9;
            --text-light: #94a3b8;
            --accent-blue: #38bdf8;
            --accent-green: #4ade80;
            --accent-gradient: linear-gradient(135deg, #38bdf8, #0ea5e9);
            --green-gradient: linear-gradient(135deg, #4ade80, #22c55e);
            --card-shadow: 0 4px 12px rgba(0,0,0,0.3);
            --item-border: #334155;
            --nav-bg: rgba(30, 41, 59, 0.85);
            --nav-border: rgba(255, 255, 255, 0.1);
            --coupon-blue-bg: rgba(56, 189, 248, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0; padding: 16px; line-height: 1.4;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 120px;
            transition: background 0.3s, color 0.3s;
        }

        .screen { display: none; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI Elements --- */
        .terminal-header { padding: 30px 10px 10px; }
        .terminal-badge {
            display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px;
            background: var(--accent-blue); color: white; font-size: 10px; font-weight: 900;
            border-radius: 4px; text-transform: uppercase; margin-bottom: 12px; letter-spacing: 1px;
        }
        .market-dot { width: 8px; height: 8px; border-radius: 50%; background: #ccc; }
        .dot-online { background: #2ecc71; box-shadow: 0 0 8px #2ecc71; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .home-title { font-size: 26px; font-weight: 800; margin-bottom: 10px; line-height: 1.2; }
        .home-desc { font-size: 15px; color: var(--text-light); line-height: 1.6; margin-bottom: 25px; }

        /* Market Grid */
        .market-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 25px; }
        .market-item-modern {
            background: var(--card-bg); border-radius: 16px; padding: 12px 8px;
            position: relative; overflow: hidden; box-shadow: var(--card-shadow);
            border: 1px solid var(--item-border); display: flex; flex-direction: column; align-items: center;
        }
        .market-item-modern::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 3px; background: #eee; }
        .market-item-modern.blue::before { background: var(--accent-blue); }
        .market-item-modern.green::before { background: var(--accent-green); }
        .market-item-modern.orange::before { background: #f39c12; }
        .mk-label { font-size: 10px; font-weight: 700; color: var(--text-light); margin-bottom: 4px; }
        .mk-val { font-size: 13px; font-weight: 900; color: var(--text-main); }

        /* Modern Info Cards (Stocks/Bonds) */
        .asset-card-modern {
            background: var(--card-bg); border-radius: 20px; padding: 20px; margin-bottom: 15px;
            box-shadow: var(--card-shadow); border: 1px solid var(--item-border);
            position: relative; overflow: hidden;
        }
        .asset-card-icon { position: absolute; top: -10px; right: -10px; font-size: 60px; opacity: 0.05; transform: rotate(15deg); }
        .asset-card-header { font-size: 18px; font-weight: 800; margin-bottom: 5px; z-index: 1; position: relative; }
        .asset-card-sub { font-size: 11px; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; opacity: 0.8; }
        .asset-card-text { font-size: 13px; color: var(--text-light); line-height: 1.5; margin-bottom: 15px; text-align: justify; }
        .asset-card-footer { 
            display: inline-block; padding: 6px 12px; border-radius: 8px; 
            font-size: 10px; font-weight: 900; text-transform: uppercase; 
        }
        
        /* Styles for specific cards */
        .card-bond .asset-card-header { color: var(--accent-blue); }
        .card-bond .asset-card-sub { color: var(--accent-blue); }
        .card-bond .asset-card-footer { background: rgba(52, 152, 219, 0.1); color: var(--accent-blue); }
        
        .card-stock .asset-card-header { color: var(--accent-green); }
        .card-stock .asset-card-sub { color: var(--accent-green); }
        .card-stock .asset-card-footer { background: rgba(46, 204, 113, 0.1); color: var(--accent-green); }

        /* Start Button */
        .btn-modern-start {
            background: var(--text-main); color: var(--bg-color); 
            border: none; padding: 18px; border-radius: 20px; width: 100%;
            font-size: 16px; font-weight: 800; cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); margin-top: 10px;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            position: relative; overflow: hidden;
        }
        .dark-mode .btn-modern-start { background: #fff; color: #000; }
        .btn-modern-start:active { transform: scale(0.98); }
        .start-btn-desc { font-size: 11px; text-align: center; color: var(--text-light); margin-top: 12px; padding: 0 10px; line-height: 1.4; }

        /* Common Elements */
        .section-header { margin: 25px 0 10px; font-weight: bold; font-size: 18px; }
        .calc-box { background: var(--card-bg); padding: 24px; border-radius: 24px; box-shadow: var(--card-shadow); margin-bottom: 25px; border: 1px solid var(--item-border); }
        .input-wrapper input { border: none; font-size: 34px; font-weight: 700; width: 100%; outline: none; background: transparent; color: var(--text-main); padding: 0; }
        .ratio-slider { -webkit-appearance: none; width: 100%; height: 6px; border-radius: 5px; background: #e0e0e0; margin: 15px 0; }
        .ratio-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: var(--accent-blue); border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        
        /* Asset Lists */
        .asset-list { background: var(--card-bg); border-radius: 12px; margin-bottom: 15px; overflow: hidden; }
        .asset-item { display: grid; grid-template-columns: 85px 1fr 75px 80px; padding: 12px; border-bottom: 1px solid var(--item-border); font-size: 12px; align-items: center; }
        .asset-item.active .details { display: block; grid-column: 1/-1; padding: 10px; background: rgba(0,0,0,0.02); color: var(--text-light); font-size: 11px; margin-top: 5px; }
        .details { display: none; }

        /* Coupon Box & Rain */
        .coupon-box { background: var(--card-bg); border-radius: 16px; margin-top: 15px; border: 1px solid var(--accent-blue); overflow: hidden; margin-bottom: 20px; }
        .coupon-header { padding: 14px; background: var(--coupon-blue-bg); color: var(--accent-blue); font-weight: bold; font-size: 14px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .coupon-content { display: none; padding: 0 12px 12px; }
        .coupon-content.active { display: block; }
        
        /* Badges */
        .calc-badge-modern { font-size: 10px; background: var(--text-main); color: var(--bg-color); padding: 4px 10px; border-radius: 20px; font-weight: 700; }
        .percent-tag { background: var(--accent-blue); padding: 5px 12px; border-radius: 20px; font-weight: 800; font-size: 11px; color: white; }
        
        /* OFZ Card Modern (Screen 3) */
        .ofz-card-modern {
            background: var(--card-bg); border-radius: 14px; padding: 12px 14px; margin-bottom: 8px;
            border: 1px solid var(--item-border); display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 6px var(--card-shadow); cursor: pointer;
        }
        .ofz-left { display: flex; flex-direction: column; gap: 3px; flex: 1; padding-right: 10px; }
        .ofz-name-row { display: flex; align-items: center; gap: 5px; }
        .ofz-name-txt { font-weight: 700; font-size: 13px; color: var(--text-main); line-height: 1.2; }
        .ofz-sub { font-size: 10px; color: var(--text-light); }
        .ofz-right { display: flex; align-items: center; }
        .ofz-yield-tag { font-weight: 800; font-size: 13px; color: var(--accent-green); background: rgba(46, 204, 113, 0.1); padding: 4px 8px; border-radius: 6px; white-space: nowrap; }

        /* Calc Row Modern (Screen 3) */
        .calc-row-modern { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px dashed var(--item-border); }
        .calc-name { font-size: 12px; font-weight: bold; color: var(--text-main); flex: 1; margin-right: 10px; }
        .qty-controls { display: flex; align-items: center; gap: 4px; background: var(--bg-color); padding: 2px; border-radius: 8px; border: 1px solid var(--item-border); }
        .qty-btn { width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-main); cursor: pointer; }
        .qty-btn:active { background: #ddd; }
        .qty-input { width: 30px; border: none; font-size: 13px; font-weight: bold; text-align: center; background: transparent; outline: none; color: var(--text-main); padding: 0; }
        .reset-btn { width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; color: var(--danger); cursor: pointer; font-size: 14px; opacity: 0.6; }

        /* Icons & Tooltips */
        .icon-svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .info-i-trigger { opacity: 0.4; cursor: pointer; transition: opacity 0.2s; display: inline-flex; vertical-align: middle; }
        .info-i-trigger:active { opacity: 1; }
        
        .tooltip-box {
            position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); color: white; padding: 15px; border-radius: 12px;
            font-size: 12px; max-width: 250px; text-align: center; z-index: 2000;
            display: none; animation: fadeIn 0.2s; pointer-events: none;
        }
        .tooltip-box.show { display: block; }

        /* Bottom Info Block */
        .bottom-info-block {
            background: var(--card-bg); border: 1px solid var(--accent-blue); border-radius: 12px; padding: 15px;
            margin-top: 20px; display: flex; align-items: flex-start; gap: 12px;
        }
        .bottom-icon { width: 24px; height: 24px; color: var(--accent-blue); flex-shrink: 0; }
        
        /* Nav */
        .nav-wrapper { position: fixed; bottom: 25px; left: 0; width: 100%; display: flex; justify-content: center; gap: 10px; padding: 0 15px; box-sizing: border-box; z-index: 900; }
        .nav-dock { background: var(--nav-bg); backdrop-filter: blur(20px); border-radius: 25px; display: flex; align-items: center; padding: 8px 15px; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid var(--nav-border); }
        .nav-item { display: flex; align-items: center; justify-content: center; width: 44px; height: 44px; border-radius: 15px; cursor: pointer; color: var(--text-light); }
        .nav-item.active { color: var(--accent-blue); background: rgba(52, 152, 219, 0.1); }
        .nav-search-btn { width: 50px; height: 50px; border-radius: 50%; background: var(--nav-bg); backdrop-filter: blur(20px); display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid var(--nav-border); cursor: pointer; color: var(--text-light); }
        .nav-search-btn.active { background: var(--accent-blue); color: white; }

        /* Helpers */
        .btn-action { margin-bottom: 20px; }
        .toast { visibility: hidden; min-width: 200px; background-color: #333; color: #fff; text-align: center; border-radius: 8px; padding: 12px; position: fixed; z-index: 1000; bottom: 100px; left: 50%; transform: translateX(-50%); font-size: 14px; opacity: 0; transition: opacity 0.3s; }
        .toast.show { visibility: visible; opacity: 1; }
        .tax-selector-ui { display: flex; background: var(--bg-color); border-radius: 10px; padding: 3px; gap: 2px; }
        .tax-ui-btn { flex: 1; border: none; background: transparent; padding: 8px; font-size: 11px; font-weight: bold; color: var(--text-light); border-radius: 8px; cursor: pointer; }
        .tax-ui-btn.active { background: var(--card-bg); color: var(--accent-blue); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* Search Screen */
        .search-input { width: 100%; padding: 16px; border-radius: 16px; border: 1px solid var(--item-border); background: var(--card-bg); color: var(--text-main); font-size: 16px; outline: none; margin-bottom: 15px; box-sizing: border-box; }
        .search-result-item { background: var(--card-bg); padding: 15px; border-radius: 12px; margin-bottom: 10px; border: 1px solid var(--item-border); }
    </style>
</head>
<body onclick="hideTooltips(event)">

    <div id="toast" class="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
    <div id="globalTooltip" class="tooltip-box"></div>

    <!-- SCREEN 1: HOME -->
    <div id="screen-home" class="screen active">
        <div class="terminal-header">
            <div class="terminal-badge">
                <span id="market-status-dot" class="market-dot"></span>
                <span>MADAME SOLOMI‚ÄôNA: TERMINAL</span>
            </div>
            <div class="home-title">–î–æ–±—Ä–æ –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å! üéâ</div>
            <div class="home-desc">–≠—Ç–æ –º–∏–Ω–∏-–ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –≤—ã–±–æ—Ä—É —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤. –ü–æ–º–æ–≥–∞–µ–º –¥–µ–ª–∞—Ç—å –ò–∫—Å—ã! üòÅ</div>
            
            <div class="market-grid">
                <div class="market-item-modern blue"><div class="mk-label">IMOEX</div><div class="mk-val" id="val-imoex">...</div></div>
                <div class="market-item-modern green"><div class="mk-label">USD/RUB</div><div class="mk-val" id="val-usdrub">...</div></div>
                <div class="market-item-modern orange"><div class="mk-label">BTC/USD</div><div class="mk-val" id="val-btc">...</div></div>
            </div>

            <div class="asset-card-modern card-bond">
                <div class="asset-card-icon">üõ°Ô∏è</div>
                <div class="asset-card-header">üõ°Ô∏è –û–±–ª–∏–≥–∞—Ü–∏–∏</div>
                <div class="asset-card-sub">–í–∞—à "–î–µ–Ω–µ–∂–Ω—ã–π –ü–æ—Ç–æ–∫"</div>
                <div class="asset-card-text">–≠—Ç–æ –∫–∞–∫ –¥–∞—Ç—å –≤ –¥–æ–ª–≥ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤—É. –û–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç –¥–µ–Ω–µ–≥ –∏ –ø–ª–∞—Ç–∏—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã. –û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –Ω–∞–¥–µ–∂–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ–Ω—å–≥–∏.</div>
                <div class="asset-card-footer">–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è</div>
            </div>

            <div class="asset-card-modern card-stock">
                <div class="asset-card-icon">üöÄ</div>
                <div class="asset-card-header">üöÄ –ê–∫—Ü–∏–∏</div>
                <div class="asset-card-sub">–í–∞—à "–î–≤–∏–≥–∞—Ç–µ–ª—å –†–æ—Å—Ç–∞"</div>
                <div class="asset-card-text">–í—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å —Å–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–º –°–±–µ—Ä–∞, –ì–∞–∑–ø—Ä–æ–º–∞ –∏ –¥—Ä—É–≥–∏—Ö –≥–∏–≥–∞–Ω—Ç–æ–≤. –ö–æ–≥–¥–∞ –æ–Ω–∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∏ —Ä–∞—Å—Ç—É—Ç ‚Äî —Ä–∞—Å—Ç–µ—Ç –∏ –≤–∞—à –∫–∞–ø–∏—Ç–∞–ª.</div>
                <div class="asset-card-footer">–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è</div>
            </div>

            <button class="btn-modern-start" onclick="showScreen('screen-app')">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                –ù–∞—á–∞—Ç—å —Ä–∞—Å—á–µ—Ç
            </button>
            <div class="start-btn-desc">
                –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —ç—Ç—É –∫–Ω–æ–ø–∫—É –í–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω —Å–ø–∏—Å–æ–∫ –∏–∑ 8 –û–±–ª–∏–≥–∞—Ü–∏–π –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –ó–∞–π–º–∞ –∏ 12 –ê–∫—Ü–∏–π –ü—É–±–ª–∏—á–Ω—ã—Ö –ö–æ–º–ø–∞–Ω–∏–π –∫ –ø–æ–∫—É–ø–∫–µ.
            </div>
        </div>
    </div>

    <!-- SCREEN 2: CALCULATOR (APP) -->
    <div id="screen-app" class="screen">
        <div class="header">
            <h1>–ö–∞–∫ –í–ª–æ–∂–∏—Ç—å?</h1>
            <p style="font-size: 13px; color: #666;" id="dynamicSubtitle">–°–∏—Å—Ç–µ–º–∞ 50/50</p>
        </div>

        <div class="calc-box">
            <div class="calc-top">
                <div class="input-container">
                    <span class="input-label">–°—É–º–º–∞ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–π</span>
                    <div class="input-wrapper">
                        <input type="number" id="sumInput" value="100000" oninput="draw()" onclick="this.select()">
                        <span class="currency">‚ÇΩ</span>
                    </div>
                </div>
                <div id="mainChart" class="chart-mini" data-pct="50/50" onclick="resetRatio()"></div>
            </div>
            <div class="ratio-control">
                <input type="range" id="ratioSlider" class="ratio-slider" min="0" max="100" value="50" oninput="draw()">
            </div>
        </div>

        <div id="shareContainer">
            <div style="text-align:center; padding:10px; display:none;" id="shareBrand">
                <h2 style="margin:0;color:#3498db;">–ú–æ—è –°—Ç—Ä–∞—Ç–µ–≥–∏—è</h2><div id="shareDate" style="font-size:10px;color:#888;"></div>
            </div>
            
            <div class="section-header">1. –î–µ–Ω–µ–∂–Ω—ã–π –ü–æ—Ç–æ–∫</div>
            <div class="allocation-info">
                <span>–í—ã–¥–µ–ª–∏—Ç—å: <b id="valBonds">...</b> ‚ÇΩ</span>
                <span class="percent-tag"><span class="bond-pct-text">50</span>%</span>
            </div>
            <div id="listBonds" class="asset-list"></div>

            <div class="coupon-box" id="couponBox">
                <div class="coupon-header" onclick="document.getElementById('couponContent').classList.toggle('active')">
                    <div style="display:flex; align-items:center; gap:5px;">
                        <span>üå¶ –ö—É–ø–æ–Ω–Ω—ã–π –î–æ–∂–¥—å</span>
                        <div class="info-i-trigger" onclick="event.stopPropagation(); showToastTooltip('–≠—Ç–æ –±–ª–∏–∂–∞–π—à–∏–µ –≤—ã–ø–ª–∞—Ç—ã –∫—É–ø–æ–Ω–æ–≤')">
                            <svg class="icon-svg" style="width:16px;height:16px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                        </div>
                    </div>
                    <span id="couponTotalHeader">0 ‚ÇΩ</span>
                </div>
                <div class="coupon-content" id="couponContent">
                    <div class="tax-selector-ui" id="taxGroup">
                        <button class="tax-ui-btn" onclick="setTax(0, this)">–ë–µ–∑ –Ω–∞–ª–æ–≥–∞</button>
                        <button class="tax-ui-btn active" onclick="setTax(0.13, this)">–ù–î–§–õ 13%</button>
                        <button class="tax-ui-btn" onclick="setTax(0.15, this)">–ù–î–§–õ 15%</button>
                    </div>
                    <div id="couponList"></div>
                </div>
            </div>

            <div class="section-header">2. –†–∞—Å—Ç—É—â–∞—è —á–∞—Å—Ç—å</div>
            <div class="allocation-info">
                <span>–í—ã–¥–µ–ª–∏—Ç—å: <b id="valStocks">...</b> ‚ÇΩ</span>
                <span class="percent-tag"><span class="stock-pct-text">50</span>%</span>
            </div>
            <div id="echelonContainer"></div>
        </div>

        <button class="btn-action" id="btnShare" onclick="shareAsPDF()">
            <svg class="icon-svg" style="margin-right:8px;" viewBox="0 0 24 24"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
            –ü–æ–¥–µ–ª–∏—Ç—å—Å—è PDF (–ü–æ—Ä—Ç—Ñ–µ–ª—å)
        </button>
    </div>

    <!-- SCREEN 3: ASSETS -->
    <div id="screen-assets" class="screen">
        <div class="header"><h1>–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¶–µ–Ω—Ç—Ä</h1></div>
        
        <div class="section-header">üõ°Ô∏è –õ—É—á—à–∏–µ –û–§–ó</div>
        <div id="ofz-list"></div>

        <div class="coupon-box" style="margin-top:20px;">
            <div class="coupon-header" onclick="document.getElementById('calc-income-wrapper').classList.toggle('active')">
                <span>üìÖ –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥</span>
                <span class="calc-badge-modern">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</span>
            </div>
            <div class="coupon-content active" id="calc-income-wrapper">
                <div class="tax-selector-ui" style="margin:10px 0;">
                    <button class="tax-ui-btn" id="tax-custom-0" onclick="setCustomTax(0, this)">–ë–µ–∑ –Ω–∞–ª–æ–≥–∞</button>
                    <button class="tax-ui-btn active" id="tax-custom-13" onclick="setCustomTax(0.13, this)">–ù–î–§–õ 13%</button>
                    <button class="tax-ui-btn" id="tax-custom-15" onclick="setCustomTax(0.15, this)">–ù–î–§–õ 15%</button>
                </div>
                <div style="font-size:10px; color:#8e8e93; margin-bottom:5px; text-transform:uppercase;">–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª-–≤–æ (—à—Ç):</div>
                <div id="calc-bonds-input-list"></div>
                <div class="result-list-container">
                    <div style="font-weight:bold; font-size:12px; margin-bottom:8px; color:var(--accent-blue);">–í–∞—à–∏ –≤—ã–ø–ª–∞—Ç—ã:</div>
                    <div id="calc-results-list" style="font-size:11px; color:#666;"></div>
                </div>
            </div>
        </div>

        <div class="section-header">üöÄ –¢–∞–±–ª–∏—Ü–∞ –≠—à–µ–ª–æ–Ω–æ–≤</div>
        <div id="echelon-table-container" style="background:var(--card-bg); border-radius:16px; padding:15px; box-shadow:var(--card-shadow); overflow-x:auto;">
            <table style="width:100%; border-collapse:separate; border-spacing:4px; font-size:11px; text-align:center;">
                <thead><tr>
                    <th><div class="percent-tag" style="opacity:0.6;">I</div></th>
                    <th><div class="percent-tag" style="opacity:0.6;">II</div></th>
                    <th><div class="percent-tag" style="opacity:0.6;">III</div></th>
                    <th><div class="percent-tag" style="opacity:0.6;">IV</div></th>
                </tr></thead>
                <tbody id="echelon-tickers-body"></tbody>
            </table>
        </div>

        <div class="bottom-info-block">
            <svg class="bottom-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
            <div style="font-size:11px; color:var(--text-main); line-height:1.4;">
                –¢–∞—Ä–≥–µ—Ç –ø–æ –∞–∫—Ü–∏—è–º ‚Äî —ç—Ç–æ <span style="color:var(--accent-blue);font-weight:bold;">–æ—Ä–∏–µ–Ω—Ç–∏—Ä –Ω–∞ –ø–µ—Ä–∏–æ–¥ –¥–æ 36 –º–µ—Å—è—Ü–µ–≤</span>.<br>
                –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π —Ç–∏–∫–µ—Ä –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.
            </div>
        </div>

        <button class="btn-action" style="margin-top:25px; background:var(--card-bg); color:var(--text-main); border:1px solid var(--item-border);" onclick="showScreen('screen-search')">
            <svg class="icon-svg" style="margin-right:8px;" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            –ü–æ–∏—Å–∫ –ø–æ —Ç–∏–∫–µ—Ä—É
        </button>
    </div>

    <!-- SCREEN 4: SEARCH -->
    <div id="screen-search" class="screen">
        <div class="header"><h1>–ü–æ–∏—Å–∫ –ê–∫—Ç–∏–≤–∞</h1></div>
        <div class="search-container">
            <input type="text" class="search-input" placeholder="–¢–∏–∫–µ—Ä, –Ω–∞–∑–≤–∞–Ω–∏–µ..." oninput="performSearch(this.value)">
        </div>
        <div id="search-results"></div>
    </div>

    <!-- NAV DOCK -->
    <div class="nav-wrapper">
        <div class="nav-dock">
            <div class="nav-item active" id="nav-home" onclick="showScreen('screen-home')"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></div>
            <div class="nav-item" id="nav-app" onclick="showScreen('screen-app')"><svg class="icon-svg" viewBox="0 0 24 24"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg></div>
            <div class="nav-item" id="nav-assets" onclick="showScreen('screen-assets')"><svg class="icon-svg" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
        </div>
        <div class="nav-search-btn" id="nav-search" onclick="showScreen('screen-search')"><svg class="icon-svg" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg></div>
    </div>

    <script>
        // --- DATA & CONFIG ---
        const SHEET_ID = '1SFV5dBIsvfX5HKbXBuXHFVvBfw1p1MPPx2uK209ajLM';
        const GID = '1213653337'; 
        const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${GID}`;
        let bonds = [], bondCouponsMap = {};
        let brokerFee = 0.0003, currentTax = 0.13, customTax = 0.13;
        let echelons = [
            { title: 'I –≠—à–µ–ª–æ–Ω', weight: 0.30, assets: [], info: '–î–∏–≤–∏–¥–µ–Ω–¥–Ω—ã–µ –∞—Ä–∏—Å—Ç–æ–∫—Ä–∞—Ç—ã' },
            { title: 'II –≠—à–µ–ª–æ–Ω', weight: 0.40, assets: [], info: '–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã' },
            { title: 'III –≠—à–µ–ª–æ–Ω', weight: 0.15, assets: [], info: '–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞ —Ä–æ—Å—Ç–∞' },
            { title: 'IV –≠—à–µ–ª–æ–Ω', weight: 0.15, assets: [], info: '–†–∏—Å–∫–æ–≤—ã–µ –∞–∫—Ç–∏–≤—ã' }
        ];

        // --- INIT & NAVIGATION ---
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo({top:0, behavior:'smooth'});
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('nav-search').classList.remove('active');
            if(id === 'screen-home') document.getElementById('nav-home').classList.add('active');
            if(id === 'screen-app') document.getElementById('nav-app').classList.add('active');
            if(id === 'screen-assets') document.getElementById('nav-assets').classList.add('active');
            if(id === 'screen-search') document.getElementById('nav-search').classList.add('active');
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
        }

        // --- TOOLTIPS ---
        function showToastTooltip(text) {
            const t = document.getElementById('globalTooltip');
            t.innerHTML = text; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3500);
        }
        function hideTooltips(e) {
            if(!e.target.closest('.info-i-trigger')) document.getElementById('globalTooltip').classList.remove('show');
        }

        // --- MARKET DATA ---
        async function fetchMarket() {
            try {
                // Mockup values for stability, real fetch logic can remain
                document.getElementById('val-imoex').innerText = "2750.40";
                document.getElementById('val-usdrub').innerText = "92.50 ‚ÇΩ";
                document.getElementById('val-btc').innerText = "$68,400";
            } catch(e){}
        }
        fetchMarket();

        // --- DATA LOADING ---
        async function loadData() {
            try {
                const res = await fetch(CSV_URL); const txt = await res.text();
                const rows = txt.split('\n').map(r => r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/"/g, '').trim()));
                
                // Parse Bonds (rows 2-9)
                let bList = [];
                for(let i=2; i<=9; i++) {
                    if(rows[i] && rows[i][10]) bList.push({ t: rows[i][10], n: rows[i][11], p: parseFloat(rows[i][12].replace(',','.'))||0, y: rows[i][13]||'0%' });
                }
                const bPromises = bList.map(async (b) => {
                    try {
                        const mRes = await fetch(`https://iss.moex.com/iss/engines/stock/markets/bonds/securities/${b.t}.json?iss.meta=off&iss.only=securities`);
                        const mData = await mRes.json(); const r = mData.securities.data[0]; const c = mData.securities.columns;
                        bondCouponsMap[b.t] = { date: r[c.indexOf('NEXTCOUPON')], value: parseFloat(r[c.indexOf('COUPONVALUE')])||0 };
                        return { ...b, nkd: parseFloat(r[c.indexOf('ACCRUEDINT')])||0, matDate: r[c.indexOf('MATDATE')]||'-' };
                    } catch(e) { return {...b, nkd:0, matDate:'-'}; }
                });
                bonds = await Promise.all(bPromises);

                // Parse Stocks
                let sList = [];
                for(let i=11; i<=22; i++) {
                    if(rows[i] && rows[i][10]) sList.push({ t: rows[i][10], n: rows[i][11], p: parseFloat(rows[i][12].replace(',','.'))||0, target: rows[i][13]||'-' });
                }
                if(sList.length) {
                    echelons[0].assets = sList.slice(0,3); echelons[1].assets = sList.slice(3,6);
                    echelons[2].assets = sList.slice(6,9); echelons[3].assets = sList.slice(9,12);
                }

                draw();
                renderAssetsScreen();
            } catch(e) { console.error(e); }
        }

        // --- CALC LOGIC (SCREEN 2) ---
        function draw() {
            const sum = parseFloat(document.getElementById('sumInput').value)||0;
            const pct = parseInt(document.getElementById('ratioSlider').value);
            
            document.querySelector('.bond-pct-text').innerText = pct;
            document.querySelector('.stock-pct-text').innerText = 100-pct;
            document.getElementById('mainChart').style.background = `conic-gradient(var(--accent-blue) 0% ${pct}%, var(--accent-green) ${pct}% 100%)`;
            document.getElementById('mainChart').setAttribute('data-pct', `${pct}/${100-pct}`);

            const bBudget = sum * (pct/100);
            const sBudget = sum * ((100-pct)/100);
            document.getElementById('valBonds').innerText = Math.round(bBudget).toLocaleString();
            document.getElementById('valStocks').innerText = Math.round(sBudget).toLocaleString();

            // Bonds List
            let bHtml = ''; let bQtyMap = {};
            if(bonds.length) {
                const perB = bBudget / bonds.length;
                let calcs = bonds.map(b => {
                    const price = (b.p + (b.nkd||0)) * (1+brokerFee);
                    const qty = price>0 ? Math.floor(perB/price) : 0;
                    return { ...b, qty, price };
                });
                // Distribute remainder
                let spent = calcs.reduce((a,c) => a + c.qty*c.price, 0);
                if(bBudget - spent > calcs[0].price) calcs[0].qty += Math.floor((bBudget-spent)/calcs[0].price);

                calcs.forEach(c => {
                    bQtyMap[c.t] = c.qty;
                    bHtml += `<div class="asset-item" onclick="this.classList.toggle('active')">
                        <span class="ticker">${c.t}</span>
                        <span class="asset-name">${c.n.substring(0,18)}</span>
                        <span class="qty">${c.qty} —à—Ç</span>
                        <span class="price-total">${Math.round(c.qty*c.p).toLocaleString()}‚ÇΩ</span>
                        <div class="details">–¶–µ–Ω–∞: ${c.p}‚ÇΩ | –ù–ö–î: ${c.nkd}‚ÇΩ | –ü–æ–≥–∞—à–µ–Ω–∏–µ: ${c.matDate} | –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: ${c.y}</div>
                    </div>`;
                });
            }
            document.getElementById('listBonds').innerHTML = bHtml;
            updateCouponRain(bQtyMap);

            // Stocks List
            let sHtml = '';
            echelons.forEach(e => {
                const eBudget = sBudget * e.weight;
                const perS = e.assets.length ? eBudget/e.assets.length : 0;
                sHtml += `<div class="echelon-title"><span>${e.title}</span><span class="percent-tag">${Math.round(e.weight*100)}%</span></div><div class="asset-list">`;
                
                let calcs = e.assets.map(a => {
                    const price = a.p * (1+brokerFee);
                    const qty = price>0 ? Math.floor(perS/price) : 0;
                    return { ...a, qty, price };
                });
                let spent = calcs.reduce((a,c) => a + c.qty*c.price, 0);
                if(eBudget-spent > calcs[0].price) calcs[0].qty += Math.floor((eBudget-spent)/calcs[0].price);

                calcs.forEach(c => {
                    sHtml += `<div class="asset-item" onclick="this.classList.toggle('active')">
                        <span class="ticker">${c.t}</span>
                        <span class="asset-name">${c.n.substring(0,18)}</span>
                        <span class="qty">${c.qty} —à—Ç</span>
                        <span class="price-total">${Math.round(c.qty*c.p).toLocaleString()}‚ÇΩ</span>
                        <div class="details">–¶–µ–Ω–∞: ${c.p}‚ÇΩ | –¢–∞—Ä–≥–µ—Ç: ${c.target}</div>
                    </div>`;
                });
                sHtml += `</div>`;
            });
            document.getElementById('echelonContainer').innerHTML = sHtml;
        }

        function updateCouponRain(qtyMap) {
            let html = ''; let total = 0;
            let list = [];
            for(let t in qtyMap) {
                if(qtyMap[t] > 0 && bondCouponsMap[t]) {
                    const info = bondCouponsMap[t];
                    list.push({ d: info.date, n: bonds.find(b=>b.t==t).n, q: qtyMap[t], v: (info.value*qtyMap[t])*(1-currentTax) });
                }
            }
            list.sort((a,b) => new Date(a.d)-new Date(b.d));
            list.forEach(i => {
                total += i.v;
                html += `<div class="coupon-row" style="display:grid; grid-template-columns:80px 1fr 50px 70px; gap:5px; font-size:11px; padding:8px 0; border-bottom:1px solid #eee;">
                    <div>${new Date(i.d).toLocaleDateString()}</div>
                    <div style="color:#888;">${i.n.substring(0,15)}</div>
                    <div style="text-align:center;">${i.q}</div>
                    <div style="text-align:right;font-weight:bold;">${Math.round(i.v).toLocaleString()}‚ÇΩ</div>
                </div>`;
            });
            document.getElementById('couponList').innerHTML = html || '<div style="text-align:center;padding:10px;color:#999;">–ù–µ—Ç –≤—ã–ø–ª–∞—Ç</div>';
            document.getElementById('couponTotalHeader').innerText = Math.round(total).toLocaleString() + ' ‚ÇΩ';
        }

        function setTax(v, btn) {
            currentTax = v;
            document.querySelectorAll('#taxGroup .tax-ui-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            draw();
        }

        // --- SCREEN 3 LOGIC ---
        function renderAssetsScreen() {
            // OFZ List
            let ofzHtml = '';
            bonds.forEach(b => {
                ofzHtml += `
                <div class="ofz-card-modern" onclick="copyText('${b.n}')">
                    <div class="ofz-left">
                        <div class="ofz-name-row">
                            <span class="ofz-name-txt">${b.n.substring(0,25)}</span>
                            <div class="info-i-trigger" onclick="event.stopPropagation(); showToastTooltip('–ü—Ä–æ—Å—Ç–∞—è –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∫ –ü–æ–≥–∞—à–µ–Ω–∏—é (YTM Simple) ‚Äî —Å—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä, —É–¥–µ—Ä–∂–∏–≤–∞—è –æ–±–ª–∏–≥–∞—Ü–∏—é –¥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è.')">
                                <svg class="icon-svg" style="width:14px;height:14px;" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                            </div>
                        </div>
                        <span class="ofz-sub">${b.t}</span>
                    </div>
                    <div class="ofz-right">
                        <span class="ofz-yield-tag">${b.y}</span>
                    </div>
                </div>`;
            });
            document.getElementById('ofz-list').innerHTML = ofzHtml;

            // Calc Inputs
            let cHtml = '';
            bonds.forEach(b => {
                cHtml += `
                <div class="calc-row-modern">
                    <div class="calc-name" onclick="copyText('${b.n}')">${b.n.substring(0,20)}</div>
                    <div class="qty-controls">
                        <div class="qty-btn" onclick="adjQty('${b.t}', -1)">-</div>
                        <input type="number" id="inp-${b.t}" class="qty-input" value="0" oninput="recalcCustom()">
                        <div class="qty-btn" onclick="adjQty('${b.t}', 1)">+</div>
                        <div class="reset-btn" onclick="resetQty('${b.t}')">‚úï</div>
                    </div>
                </div>`;
            });
            document.getElementById('calc-bonds-input-list').innerHTML = cHtml;

            // Echelon Table
            let tHtml = '';
            const max = Math.max(...echelons.map(e=>e.assets.length));
            for(let i=0; i<max; i++) {
                tHtml += '<tr>';
                echelons.forEach(e => {
                    if(e.assets[i]) {
                        tHtml += `<td class="echelon-cell" onclick="copyText('${e.assets[i].t}')"><b>${e.assets[i].t}</b><br><span style="color:var(--accent-green)">${e.assets[i].target}</span></td>`;
                    } else tHtml += '<td></td>';
                });
                tHtml += '</tr>';
            }
            document.getElementById('echelon-tickers-body').innerHTML = tHtml;
        }

        function adjQty(t, d) {
            const el = document.getElementById('inp-'+t);
            let v = parseInt(el.value)||0;
            v = Math.max(0, v+d);
            el.value = v;
            recalcCustom();
        }

        function resetQty(t) {
            document.getElementById('inp-'+t).value = 0;
            recalcCustom();
        }

        function recalcCustom() {
            let total = 0; let html = '';
            let items = [];
            bonds.forEach(b => {
                const q = parseInt(document.getElementById('inp-'+b.t).value)||0;
                if(q>0 && bondCouponsMap[b.t]) {
                    const i = bondCouponsMap[b.t];
                    const val = (i.value*q)*(1-customTax);
                    items.push({ d: i.date, n: b.n, q: q, v: val });
                }
            });
            items.sort((a,b) => new Date(a.d)-new Date(b.d));
            items.forEach(x => {
                total += x.v;
                html += `<div style="display:flex; justify-content:space-between; font-size:11px; padding:4px 0;">
                    <span>${new Date(x.d).toLocaleDateString()}</span>
                    <span>${x.n.substring(0,10)}..</span>
                    <b>${Math.round(x.v)}‚ÇΩ</b>
                </div>`;
            });
            if(total > 0) html += `<div style="text-align:right; margin-top:5px; font-weight:bold; color:var(--accent-blue);">–ò—Ç–æ–≥–æ: ${Math.round(total)} ‚ÇΩ</div>`;
            else html = '<div>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
            document.getElementById('calc-results-list').innerHTML = html;
        }

        function setCustomTax(v, btn) {
            customTax = v;
            document.querySelectorAll('#calc-income-wrapper .tax-ui-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            recalcCustom();
        }

        // --- ACTIONS ---
        function copyText(txt) {
            navigator.clipboard.writeText(txt);
            const t = document.getElementById('toast');
            t.innerText = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ: " + txt;
            t.classList.add('show');
            setTimeout(()=>t.classList.remove('show'), 2000);
        }

        function performSearch(q) {
            const c = document.getElementById('search-results'); c.innerHTML = '';
            if(!q) return;
            q = q.toUpperCase();
            let res = [];
            [...bonds, ...echelons.flatMap(e=>e.assets)].forEach(a => {
                if(a.t.includes(q) || a.n.toUpperCase().includes(q)) res.push(a);
            });
            res.forEach(r => {
                c.innerHTML += `<div class="search-result-item" onclick="copyText('${r.t}')">
                    <div style="font-weight:bold;">${r.t}</div>
                    <div style="font-size:12px;color:#888;">${r.n}</div>
                </div>`;
            });
        }

        async function shareAsPDF() {
            const btn = document.getElementById('btnShare');
            const con = document.getElementById('shareContainer');
            const brand = document.getElementById('shareBrand');
            
            btn.innerText = "‚è≥ –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ PDF...";
            brand.style.display = 'block';
            document.getElementById('shareDate').innerText = new Date().toLocaleString();

            try {
                // 1. Capture
                const canvas = await html2canvas(con, { scale: 3, backgroundColor: getComputedStyle(document.body).getPropertyValue('--bg-color') });
                
                // 2. Generate PDF (One Long Page)
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({ orientation: 'p', unit: 'px', format: [canvas.width, canvas.height] });
                doc.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, canvas.width, canvas.height);
                
                const pdfBlob = doc.output('blob');
                const pdfFile = new File([pdfBlob], "Invest_Portfolio.pdf", { type: "application/pdf" });

                // 3. Share via Native OS (Standard Telegram behavior)
                if (navigator.share && navigator.canShare({ files: [pdfFile] })) {
                    await navigator.share({
                        files: [pdfFile],
                        title: '–ú–æ–π –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ü–æ—Ä—Ç—Ñ–µ–ª—å',
                        text: '–°–º–æ—Ç—Ä–∏, –∫–∞–∫–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å —è —Å–æ–±—Ä–∞–ª!'
                    });
                    // Success callback
                    showScreen('screen-app');
                } else {
                    // Fallback
                    doc.save("Invest_Portfolio.pdf");
                    showScreen('screen-app');
                }

            } catch(e) {
                alert("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è PDF –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏");
                console.error(e);
            } finally {
                btn.innerHTML = `<svg class="icon-svg" style="margin-right:8px;" viewBox="0 0 24 24"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è PDF (–ü–æ—Ä—Ç—Ñ–µ–ª—å)`;
                brand.style.display = 'none';
            }
        }

        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();
        loadData();
    </script>
</body>
</html>

